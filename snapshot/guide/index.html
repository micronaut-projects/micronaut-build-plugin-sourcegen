<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
    <title>Micronaut Build Plugin Sourcegen</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1, maximum-scale=1" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <link rel="stylesheet" href="../css/main.css" type="text/css" media="screen, print" title="Style" charset="utf-8" />
    <link rel="stylesheet" href="../css/custom.css" type="text/css" media="screen, print" title="Style" charset="utf-8" />
    <link rel="stylesheet" href="../css/pdf.css" type="text/css" media="print" title="PDF" charset="utf-8" />
    <link rel="stylesheet" href="../css/highlight/agate.css">
    <script src="../js/highlight.pack.js"></script>
    <script src="../js/guide.js"></script>
    <script src="../js/multi-language-sample.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <link rel="stylesheet" href="../css/multi-language-sample.css"/>
    <script src="../js/docs.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.5.13/clipboard.min.js"></script>
    <script type="text/javascript">
        function addJsClass(el) {
            var classes = document.body.className.split(" ");
            classes.push("js");
            document.body.className = classes.join(" ");
        }
    </script>

</head>

<body class="body" id="docs" onload="addJsClass();" onhashchange="highlightMenu()">

<div id="table-of-content-nav-link" class="desktop">
    <a id="theme-switcher" title="Switch to dark theme" href="javascript:switchTheme(true)"><i class="fa fa-moon-o"></i></a>
    <a title="Collapse/Open Table of contents" title="Hide Table of Contents" href="javascript:hideTableOfContents();" class="button">[ + ]</a>
</div>

<div id="main">
    <div id="navigation" class="no-print">
        <div class="navTitle">
            <span id="logo"><a href="http://micronaut.io" title="Go to Micronaut Website"><img src="../img/micronaut-logo-white.svg" alt="Micronaut"/></a></span>
        </div>
        <div class="navLinks">
            <ul>
                    <li><div id="nav-summary" onmouseover="toggleNavSummary(false)" onmouseout="toggleNavSummary(true)" class="desktop">
                            <a href="../guide/index.html" class="button">Table of contents</a>
                            <div id="nav-summary-childs" style="display:none;">
                                
                                <div class="toc-item" style="margin-left:0"><a href="#introduction"><strong>1</strong><span>Introduction</span></a></div>
                                
                                <div class="toc-item" style="margin-left:0"><a href="#releaseHistory"><strong>2</strong><span>Release History</span></a></div>
                                
                                <div class="toc-item" style="margin-left:0"><a href="#gettingStarted"><strong>3</strong><span>Getting Started</span></a></div>
                                
                                <div class="toc-item" style="margin-left:0"><a href="#repository"><strong>4</strong><span>Repository</span></a></div>
                                
                            </div>
                        </div>
                    </li>

                <li id="table-of-content-nav-link-mobile" class="mobile">
                    <a title="Scroll to Table of contents" href="javascript:scrollToTop();" class="button">Toc</a>
                </li>
                <li class="desktop">
                    <a title="Go to API documentation" href="../api/index.html" class="button">API Reference</a>
                </li>
                <li class="mobile">
                    <a title="Go to API documentation" href="../api/index.html" class="button">API</a>
                </li>
                <li class="desktop">
                    <a title="Go to Configuration Reference documentation" href="../guide/configurationreference.html" class="button">Configuration Reference</a>
                </li>
                <li class="mobile">
                    <a title="Go to Configuration Reference documentation" href="../guide/configurationreference.html" class="button">Conf</a>
                </li>
            </ul>

        </div>
    </div>
    
    <div id="table-of-content">
        <div class="toc-content">

        <h2>Table of Contents</h2>
        
        <div class="toc-item" style="margin-left:0px" id="toc-item-introduction"><a href="#introduction"><strong>1</strong><span>Introduction</span></a></div>
        
        <div class="toc-item" style="margin-left:0px" id="toc-item-releaseHistory"><a href="#releaseHistory"><strong>2</strong><span>Release History</span></a></div>
        
        <div class="toc-item" style="margin-left:0px" id="toc-item-gettingStarted"><a href="#gettingStarted"><strong>3</strong><span>Getting Started</span></a></div>
        
        <div class="toc-item" style="margin-left:10px" id="toc-item-commonModule"><a href="#commonModule"><strong>3.1</strong><span>Common Module</span></a></div>
        
        <div class="toc-item" style="margin-left:10px" id="toc-item-gradleModule"><a href="#gradleModule"><strong>3.2</strong><span>Gradle Module</span></a></div>
        
        <div class="toc-item" style="margin-left:10px" id="toc-item-mavenModule"><a href="#mavenModule"><strong>3.3</strong><span>Maven Module</span></a></div>
        
        <div class="toc-item" style="margin-left:0px" id="toc-item-repository"><a href="#repository"><strong>4</strong><span>Repository</span></a></div>
        
        </div>
    </div>
    
    <div class="docs-content">
    <div class="project">
        <h1>Micronaut Build Plugin Sourcegen</h1>
        <p></p>
        <p>Project for generating sources of build plugin tasks</p>
        <p><strong>Version:</strong> 0.0.1-SNAPSHOT </p>
    </div>
    
<h1 id="introduction"><a class="anchor" href="#introduction"></a>1 Introduction</h1>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/micronaut-projects/micronaut-build-plugin-sourcegen/edit/0.0.x/src/main/docs/guide/introduction.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>Micronaut Build plugin sourcegen allows generating sources of Gradle and Maven plugins.</p>
</div>
<div class="paragraph">
<p>This is most useful for resource-intensive tasks that have a considerable amount of parameters, but are not closely coupled with plugin logic. An example of such task is generating sources or resources. The idea is that developer writes task logic and describes the API, while plugin sources are generated for this project to start the task using the API.</p>
</div>
<div class="paragraph">
<p>The main advantage of using the generator is that parameters do not need to be copied manually to plugin implementations separately avoiding human error. For each parameter, default value, whether it is required and javadoc will be copied.</p>
</div>
<div class="paragraph">
<p>This project is based on <a href="https://micronaut-projects.github.io/micronaut-sourcegen/latest/guide/">Micronaut sourcegen</a>.</p>
</div>

<h1 id="releaseHistory"><a class="anchor" href="#releaseHistory"></a>2 Release History</h1>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/micronaut-projects/micronaut-build-plugin-sourcegen/edit/0.0.x/src/main/docs/guide/releaseHistory.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>For this project, you can find a list of releases (with release notes) here:</p>
</div>
<div class="paragraph">
<p><a href="https://github.com/micronaut-projects/micronaut-build-plugin-sourcegen/releases">https://github.com/micronaut-projects/micronaut-build-plugin-sourcegen/releases</a></p>
</div>

<h1 id="gettingStarted"><a class="anchor" href="#gettingStarted"></a>3 Getting Started</h1>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/micronaut-projects/micronaut-build-plugin-sourcegen/edit/0.0.x/src/main/docs/guide/gettingStarted.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>The most likely structure for a project that wants to utilize this consists of 3 modules:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Common module with task logic.</p>
</li>
<li>
<p>Module with generated Gradle plugin sources and possible user extensions.</p>
</li>
<li>
<p>Module with generated Maven plugin sources and possible user extensions.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The 3 modules might be in different repositories. It is possible to use a single module, but it is not recommended.</p>
</div>

<h2 id="commonModule"><a class="anchor" href="#commonModule"></a>3.1 Common Module</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/micronaut-projects/micronaut-build-plugin-sourcegen/edit/0.0.x/src/main/docs/guide/gettingStarted/commonModule.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>The common module should have the following dependencies:</p>
</div>
<div class="paragraph">
<p>        <div class="listingblock multi-language-sample">
<div class="title"></div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="gradle">implementation(<span class="hljs-string">"io.micronaut.build.plugin.sourcegen:micronaut-build-plugin-sourcegen-annotations")</span></code></pre>
</div>
</div>
<div class="listingblock multi-language-sample">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="maven">&lt;dependency&gt;
    &lt;groupId&gt;io.micronaut.build.plugin.sourcegen&lt;/groupId&gt;
    &lt;artifactId&gt;micronaut-build-plugin-sourcegen-annotations&lt;/artifactId&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div></p>
</div>
<div class="paragraph">
<p>        <div class="listingblock multi-language-sample">
<div class="title"></div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="gradle">annotationProcessor(<span class="hljs-string">"io.micronaut.build.plugin.sourcegen:micronaut-build-plugin-sourcegen-generator")</span></code></pre>
</div>
</div>
<div class="listingblock multi-language-sample">
<div class="title"></div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="maven">&lt;annotationProcessorPaths&gt;
    &lt;path&gt;
        &lt;groupId&gt;io.micronaut.build.plugin.sourcegen&lt;/groupId&gt;
        &lt;artifactId&gt;micronaut-build-plugin-sourcegen-generator&lt;/artifactId&gt;
    &lt;/path&gt;
&lt;/annotationProcessorPaths&gt;</code></pre>
</div>
</div></p>
</div>
<div class="paragraph">
<p>Use the <a href="../api/io/micronaut/sourcegen/annotations/PluginTask.html">PluginTask</a> annotation to define a plugin task. In this example we will create a task that can generate simple record sources. User specifies the type name, properties and javadoc information and then record is generated and added to their sources.</p>
</div>
<div class="listingblock multi-language-sample">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">import io.micronaut.sourcegen.annotations.PluginTask;
import io.micronaut.sourcegen.annotations.PluginTaskExecutable;
import io.micronaut.sourcegen.annotations.PluginTaskParameter;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;

/**
 * This is a configuration for a plugin task run.
 * The properties are parameters and the single method defines the task execution.
 * The plugin generates a simple record.
 *
 * @param typeName The generated class name
 * @param version The version
 * @param packageName The package name
 * @param properties The properties
 * @param javadoc The javadoc
 * @param outputFolder The output folder
 */
@PluginTask // <b class="conum">(1)</b>
public record GenerateSimpleRecordTask(
    @PluginTaskParameter(required = true, globalProperty = "typeName")
    String typeName, // <b class="conum">(2)</b>
    @PluginTaskParameter(defaultValue = "1", globalProperty = "version")
    Integer version, // <b class="conum">(3)</b>
    @PluginTaskParameter(defaultValue = "com.example", globalProperty = "packageName")
    String packageName,
    Map&lt;String, String&gt; properties,
    List&lt;String&gt; javadoc,
    @PluginTaskParameter(output = true, directory = true, required = true)
    File outputFolder // <b class="conum">(4)</b>
) {

    private static final Logger LOG = LoggerFactory.getLogger(GenerateSimpleRecordTask.class);

    private static final String CONTENT = """
package %s;

/**
 * Version: %s
%s
 */
public record %s(
%s
) {
}
""";

    /**
     * Generate a simple record in the supplied package and with the specified version.
     * This javadoc will be copied to the respected plugin implementations.
     */
    @PluginTaskExecutable // <b class="conum">(5)</b>
    public void generateSimpleRecord() {
        LOG.info("Generating record {}", typeName);

        File packageFolder = new File(outputFolder, "src" + File.separator
            + "main" + File.separator + "java" + File.separator
            + packageName.replace(".", File.separator));
        packageFolder.mkdirs();
        // Create the content of the file using the CONTENT template
        String content = String.format(
            CONTENT,
            packageName,
            version,
            javadoc.stream().map(v -&gt; " * " + v).collect(Collectors.joining("\n")),
            typeName,
            properties.entrySet().stream().map(e -&gt; "    " + e.getValue() + " " + e.getKey())
                .collect(Collectors.joining(",\n"))
        );
        File outputFile = new File(packageFolder, typeName + ".java");

        // Write the file
        try (BufferedWriter writer = new BufferedWriter(new FileWriter(outputFile))) {
            writer.write(content);
        } catch (IOException e) {
            throw new RuntimeException(e);
        }

        LOG.info("Finished record {}", typeName);
    }

}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Define the task. The task can be a record or a Java class.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Use the <a href="../api/io/micronaut/sourcegen/annotations/PluginTaskParameter.html">PluginTaskParameter</a> annotation to define a parameter. Set <code>required = true</code> for mandatory parameters.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Define another parameter. Set the default value if any.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>Specify <code>output = true</code> for outputs a the task.</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>Use the <a href="../api/io/micronaut/sourcegen/annotations/PluginTaskExecutable.html">PluginTaskExecutable</a> to define the executable for task. The executable will use the parameters defined for the task.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>See documentation for <a href="../api/io/micronaut/sourcegen/annotations/PluginTask.html">PluginTask</a>, <a href="../api/io/micronaut/sourcegen/annotations/PluginTaskParameter.html">PluginTaskParameter</a> and <a href="../api/io/micronaut/sourcegen/annotations/PluginTaskExecutable.html">PluginTaskExecutable</a> to view all the configurable properties.</p>
</div>

<h2 id="gradleModule"><a class="anchor" href="#gradleModule"></a>3.2 Gradle Module</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/micronaut-projects/micronaut-build-plugin-sourcegen/edit/0.0.x/src/main/docs/guide/gettingStarted/gradleModule.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>The Gradle module should have the same dependencies and also the dependency on the common module.</p>
</div>
<div class="paragraph">
<p>        <div class="listingblock multi-language-sample">
<div class="title"></div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="gradle">implementation(<span class="hljs-string">"io.micronaut.build.plugin.sourcegen:micronaut-build-plugin-sourcegen-annotations")</span></code></pre>
</div>
</div>
<div class="listingblock multi-language-sample">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="maven">&lt;dependency&gt;
    &lt;groupId&gt;io.micronaut.build.plugin.sourcegen&lt;/groupId&gt;
    &lt;artifactId&gt;micronaut-build-plugin-sourcegen-annotations&lt;/artifactId&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div></p>
</div>
<div class="paragraph">
<p>        <div class="listingblock multi-language-sample">
<div class="title"></div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="gradle">compileOnly(<span class="hljs-string">"io.micronaut.test:micronaut-test-plugin-common")</span></code></pre>
</div>
</div>
<div class="listingblock multi-language-sample">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="maven">&lt;dependency&gt;
    &lt;groupId&gt;io.micronaut.test&lt;/groupId&gt;
    &lt;artifactId&gt;micronaut-test-plugin-common&lt;/artifactId&gt;
    &lt;scope&gt;provided&lt;/scope&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div></p>
</div>
<div class="paragraph">
<p>        <div class="listingblock multi-language-sample">
<div class="title"></div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="gradle">annotationProcessor(<span class="hljs-string">"io.micronaut.build.plugin.sourcegen:micronaut-build-plugin-sourcegen-generator")</span></code></pre>
</div>
</div>
<div class="listingblock multi-language-sample">
<div class="title"></div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="maven">&lt;annotationProcessorPaths&gt;
    &lt;path&gt;
        &lt;groupId&gt;io.micronaut.build.plugin.sourcegen&lt;/groupId&gt;
        &lt;artifactId&gt;micronaut-build-plugin-sourcegen-generator&lt;/artifactId&gt;
    &lt;/path&gt;
&lt;/annotationProcessorPaths&gt;</code></pre>
</div>
</div></p>
</div>
<div class="paragraph">
<p>        <div class="listingblock multi-language-sample">
<div class="title"></div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="gradle">annotationProcessor(<span class="hljs-string">"io.micronaut.test:micronaut-test-plugin-common")</span></code></pre>
</div>
</div>
<div class="listingblock multi-language-sample">
<div class="title"></div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="maven">&lt;annotationProcessorPaths&gt;
    &lt;path&gt;
        &lt;groupId&gt;io.micronaut.test&lt;/groupId&gt;
        &lt;artifactId&gt;micronaut-test-plugin-common&lt;/artifactId&gt;
    &lt;/path&gt;
&lt;/annotationProcessorPaths&gt;</code></pre>
</div>
</div></p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Adding the common plugin to the annotation processor paths is currently required to retrieve javadoc.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Use the <a href="../api/io/micronaut/sourcegen/annotations/GenerateGradlePlugin.html">GenerateGradlePlugin</a> annotation to trigger generation of Gradle Plugin sources.</p>
</div>
<div class="listingblock multi-language-sample">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">import io.micronaut.sourcegen.annotations.GenerateGradlePlugin;
import io.micronaut.sourcegen.annotations.GenerateGradlePlugin.GenerateGradleTask;

@GenerateGradlePlugin(
    namePrefix = "Test", // <b class="conum">(1)</b>
    micronautPlugin = false,
    tasks = {
        @GenerateGradleTask(
            namePrefix = "GenerateSimpleRecord",
            extensionMethodName = "generateSimpleRecord",
            source = "io.micronaut.sourcegen.example.plugin.GenerateSimpleRecordTask" // <b class="conum">(2)</b>
        ),
        @GenerateGradleTask(
            namePrefix = "GenerateSimpleResource",
            extensionMethodName = "generateSimpleResource",
            source = "io.micronaut.sourcegen.example.plugin.GenerateSimpleResourceTask" // <b class="conum">(3)</b>
        )
    }
)
public final class GeneratePluginTrigger {
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Specify the name prefix for all generated sources. <code>TestPlugin</code> and <code>TestExtension</code> will be generated based on this.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Use the <a href="../api/io/micronaut/sourcegen/annotations/GenerateGradlePlugin/GenerateGradleTask.html">GenerateGradleTask</a> annotation to define generation of a task. Specify the task from common module annotated with <a href="../api/io/micronaut/sourcegen/annotations/PluginTask.html">PluginTask</a> as source. Based on the prefix, <code>GenerateSimpleRecordTask</code> and <code>GenerateSimpleRecordSpec</code> will be generated.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>If you create another task, you can add it to the same plugin.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The following sources will be generated based on this:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><code>TestPlugin</code> - the Gradle plugin base that adds the extension to user project.</p>
</li>
<li>
<p><code>TestExtension</code> and <code>DefaultTestExtension</code> - extension and its implementation that allow calling tasks. Each task can be configured with the corresponding extension method.</p>
</li>
<li>
<p><code>GenerateSimpleRecordTask</code> - the Gradle task that is responsible for actually calling your task logic.</p>
</li>
<li>
<p><code>GenerateSimpleRecordSpec</code> - the specification with all the task parameters that user can configure when calling the extension method.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>See documentation for <a href="../api/io/micronaut/sourcegen/annotations/GenerateGradleTask.html">GenerateGradleTask</a> to view all the configurable properties.</p>
</div>
<div class="sect2">
<h3 id="_plugin_customization">Plugin Customization</h3>
<div class="paragraph">
<p>Plugin and extension can be extended to add custom Gradle-specific behavior.</p>
</div>
<div class="listingblock multi-language-sample">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">import org.gradle.api.Action;
import org.gradle.api.GradleException;
import org.gradle.api.Project;
import org.gradle.api.artifacts.Configuration;
import org.gradle.api.plugins.JavaPluginExtension;
import org.gradle.api.tasks.SourceSet;
import org.gradle.api.tasks.SourceSetContainer;
import org.gradle.api.tasks.TaskProvider;

import java.util.function.Consumer;

/**
 * This extends a generated class to modify some behavior.
 */
public abstract class TestExtensionImpl extends DefaultTestExtension { // <b class="conum">(1)</b>

    public TestExtensionImpl(Project project, Configuration classpath) {
        super(project, classpath);
    }


    /**
     * This is an example of how you can add a utility method to the generated extension.
     * Inside it calls the generated method.
     *
     * @param typeName The type name
     * @param packageName The package name
     * @param action The spec action
     */ // <b class="conum">(2)</b>
    public void generateRecordWithName(String typeName, String packageName, Action&lt;GenerateSimpleRecordSpec&gt; action) {
        super.generateSimpleRecord("generate" + typeName, spec -&gt; {
            spec.getTypeName().set(typeName);
            spec.getPackageName().set(packageName);
            action.execute(spec);
        });
    }

    /**
     * Overriding a method to make sure that output directory has a correct default value.
     * We are also adding to source sets here.
     *
     * @param name The task name
     * @param configurator The configurator action
     * @return The task
     */
    @Override
    TaskProvider&lt;? extends GenerateSimpleRecordTask&gt; createGenerateSimpleRecordTask(
            String name, Action&lt;GenerateSimpleRecordTask&gt; configurator
    ) {
        TaskProvider&lt;? extends GenerateSimpleRecordTask&gt; task = super.createGenerateSimpleRecordTask(name, t -&gt; {
            configurator.execute(t);
            t.getOutputFolder().convention(
                project.getLayout().getBuildDirectory().dir("generated/" + t.getName())
            );
        });
        withJavaSourceSets(sourceSets -&gt; { // <b class="conum">(3)</b>
            var javaMain = sourceSets.getByName(SourceSet.MAIN_SOURCE_SET_NAME).getJava();
            javaMain.srcDir(task.map(t -&gt; t.getOutputFolder().dir("src/main/java")));
        });
        return task;
    }

    private void withJavaSourceSets(Consumer&lt;? super SourceSetContainer&gt; consumer) {
        project.getPlugins().withId("java", unused -&gt; {
            var javaPluginExtension =  project.getExtensions().findByType(JavaPluginExtension.class);
            if (javaPluginExtension == null) {
                throw new GradleException("No Java plugin extension found");
            }
            consumer.accept(javaPluginExtension.getSourceSets());
        });
    }

}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Extend the generated <code>TestExtension</code> class.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Create a utility extension method that users could call instead.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Add the generated file to sources.</td>
</tr>
</table>
</div>
</div>

<h2 id="mavenModule"><a class="anchor" href="#mavenModule"></a>3.3 Maven Module</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/micronaut-projects/micronaut-build-plugin-sourcegen/edit/0.0.x/src/main/docs/guide/gettingStarted/mavenModule.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>The Maven module should have the same dependencies and also the dependency on the common module.</p>
</div>
<div class="paragraph">
<p>        <div class="listingblock multi-language-sample">
<div class="title"></div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="gradle">implementation(<span class="hljs-string">"io.micronaut.build.plugin.sourcegen:micronaut-build-plugin-sourcegen-annotations")</span></code></pre>
</div>
</div>
<div class="listingblock multi-language-sample">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="maven">&lt;dependency&gt;
    &lt;groupId&gt;io.micronaut.build.plugin.sourcegen&lt;/groupId&gt;
    &lt;artifactId&gt;micronaut-build-plugin-sourcegen-annotations&lt;/artifactId&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div></p>
</div>
<div class="paragraph">
<p>        <div class="listingblock multi-language-sample">
<div class="title"></div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="gradle">compileOnly(<span class="hljs-string">"io.micronaut.test:micronaut-test-plugin-common")</span></code></pre>
</div>
</div>
<div class="listingblock multi-language-sample">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="maven">&lt;dependency&gt;
    &lt;groupId&gt;io.micronaut.test&lt;/groupId&gt;
    &lt;artifactId&gt;micronaut-test-plugin-common&lt;/artifactId&gt;
    &lt;scope&gt;provided&lt;/scope&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div></p>
</div>
<div class="paragraph">
<p>        <div class="listingblock multi-language-sample">
<div class="title"></div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="gradle">annotationProcessor(<span class="hljs-string">"io.micronaut.build.plugin.sourcegen:micronaut-build-plugin-sourcegen-generator")</span></code></pre>
</div>
</div>
<div class="listingblock multi-language-sample">
<div class="title"></div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="maven">&lt;annotationProcessorPaths&gt;
    &lt;path&gt;
        &lt;groupId&gt;io.micronaut.build.plugin.sourcegen&lt;/groupId&gt;
        &lt;artifactId&gt;micronaut-build-plugin-sourcegen-generator&lt;/artifactId&gt;
    &lt;/path&gt;
&lt;/annotationProcessorPaths&gt;</code></pre>
</div>
</div></p>
</div>
<div class="paragraph">
<p>        <div class="listingblock multi-language-sample">
<div class="title"></div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="gradle">annotationProcessor(<span class="hljs-string">"io.micronaut.test:micronaut-test-plugin-common")</span></code></pre>
</div>
</div>
<div class="listingblock multi-language-sample">
<div class="title"></div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="maven">&lt;annotationProcessorPaths&gt;
    &lt;path&gt;
        &lt;groupId&gt;io.micronaut.test&lt;/groupId&gt;
        &lt;artifactId&gt;micronaut-test-plugin-common&lt;/artifactId&gt;
    &lt;/path&gt;
&lt;/annotationProcessorPaths&gt;</code></pre>
</div>
</div></p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Adding the common plugin to the annotation processor paths is currently required to retrieve javadoc.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Use the <a href="../api/io/micronaut/sourcegen/annotations/GenerateMavenMojo.html">GenerateMavenMojo</a> annotation to trigger generation of Maven Plugin sources.</p>
</div>
<div class="listingblock multi-language-sample">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">import io.micronaut.sourcegen.annotations.GenerateMavenMojo;

/**
 * A class that triggers Maven Mojo generation.
 */
@GenerateMavenMojo( // <b class="conum">(1)</b>
    namePrefix = "AbstractGenerateSimpleRecord",
    micronautPlugin = false,
    source = "io.micronaut.sourcegen.example.plugin.GenerateSimpleRecordTask",
    mavenPropertyPrefix = "test.generate.simple.record"
)
@GenerateMavenMojo( // <b class="conum">(2)</b>
    namePrefix = "AbstractGenerateSimpleResource",
    micronautPlugin = false,
    source = "io.micronaut.sourcegen.example.plugin.GenerateSimpleResourceTask",
    mavenPropertyPrefix = "test.generate.simple.resource"
)
public final class GenerateMojoTrigger {
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Trigger generation of a mojo. Specify the task from common module annotated with <a href="../api/io/micronaut/sourcegen/annotations/PluginTask.html">PluginTask</a> as source. Based on the prefix, <code>AbstractGenerateSimpleRecordMojo</code> will be generated.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>If you create another task, you can generate another Mojo for it.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Only <code>AbstractGenerateSimpleRecordMojo</code> class will be generated. The mojo will have all the specified task parameters and will call the defined task as its action.</p>
</div>
<div class="paragraph">
<p>See documentation for <a href="../api/io/micronaut/sourcegen/annotations/GenerateMavenMojo.html">GenerateMavenMojo</a> to view all the configurable properties.</p>
</div>
<div class="sect2">
<h3 id="_mojo_customization">Mojo Customization</h3>
<div class="paragraph">
<p>Extend the Mojo to add custom Maven-specific behavior:</p>
</div>
<div class="listingblock multi-language-sample">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">/**
 * An extension of the generated mojo that configures the output folder.
 */
@Mojo(name = "generateSimpleRecord") // <b class="conum">(1)</b>
public class GenerateSimpleRecordMojo extends AbstractGenerateSimpleRecordMojo {

    @Parameter(
        required = true,
        defaultValue = "${project.build.directory}/generated/simpleRecord"
    )
    private File outputFolder;

    @Parameter(property = "generate.simple.record.enabled", defaultValue = "true")
    private boolean enabled; // <b class="conum">(2)</b>

    @Parameter(defaultValue = "${project}", readonly = true, required = true)
    private MavenProject project;

    @Override
    protected boolean isEnabled() {
        return enabled;
    }

    @Override
    protected File getOutputFolder() {
        return outputFolder;
    }

    @Override
    public void execute() {
        if (project != null) {
            project.addCompileSourceRoot(
                new File(outputFolder, "src/main/java".replace("/", File.separator)).getAbsolutePath()
            ); // <b class="conum">(3)</b>
        }
        super.execute();
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Specify a name for Mojo.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Add a property for enabling and disabling the mojo.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Add the generated folder to sources.</td>
</tr>
</table>
</div>
</div>

<h1 id="repository"><a class="anchor" href="#repository"></a>4 Repository</h1>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/micronaut-projects/micronaut-build-plugin-sourcegen/edit/0.0.x/src/main/docs/guide/repository.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>You can find the source code of this project in this repository:</p>
</div>
<div class="paragraph">
<p><a href="https://github.com/micronaut-projects/micronaut-build-plugin-sourcegen">https://github.com/micronaut-projects/micronaut-build-plugin-sourcegen</a></p>
</div>

    </div>
</div>

<script type="text/javascript">

</script>
</body>
</html>
